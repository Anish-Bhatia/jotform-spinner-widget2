<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Plus/Minus Spinner Table with Fixed Labels</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 10px;
    }
    th, td {
      border: none;
      padding: 12px;
      text-align: center;
      vertical-align: middle;
    }

    .spinner-cell {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      padding: 12px;
      background: #ffffff;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>
<body>

<table id="spinnerTable"></table>

<!-- JotForm Widget Scripts -->
<script src="https://cdn.jotfor.ms/js/widgetResizer.js"></script>
<script src="https://cdn.jotfor.ms/JotFormCustomWidget.js"></script>

<script>
  const labels = [
    "<span style='color: white;'>L1 Scored</span>", "<span style='color: white;'>L1 Failed</span>", 
    "<span style='color: white;'>L2 Scored</span>", "<span style='color: white;'>L2 Failed</span>",
    "<span style='color: white;'>L3 Scored</span>", "<span style='color: white;'>L3 Failed</span>", 
    "<span style='color: white;'>L4 Scored</span>", "<span style='color: white;'>L4 Failed</span>",
    "<span style='color: white;'>Processor Scored</span>", "<span style='color: white;'>Processor Failed</span>", 
    "<span style='color: white;'>Barge Scored</span>", "<span style='color: white;'>Barge Failed</span>"
  ];
  const NUM_ROWS = 6;
  const NUM_COLS = 2;

  function createLabeledSpinner(label, onChange) {
    const cellDiv = document.createElement('div');
    cellDiv.className = 'spinner-cell';

    const labelDiv = document.createElement('div');
    labelDiv.className = 'spinner-label';
    labelDiv.innerHTML = label;
    cellDiv.appendChild(labelDiv);

    const spinnerContainer = document.createElement('div');
    spinnerContainer.className = 'spinner-container';

    const minusBtn = document.createElement('button');
    minusBtn.className = 'spinner-btn';
    minusBtn.textContent = '-';

    const valueInput = document.createElement('input');
    valueInput.type = 'text';
    valueInput.className = 'spinner-value';
    valueInput.value = '0';

    const plusBtn = document.createElement('button');
    plusBtn.className = 'spinner-btn';
    plusBtn.textContent = '+';

    minusBtn.addEventListener('click', () => {
      let current = parseInt(valueInput.value, 10) || 0;
      valueInput.value = Math.max(0, current - 1);
      onChange();
    });

    plusBtn.addEventListener('click', () => {
      let current = parseInt(valueInput.value, 10) || 0;
      valueInput.value = Math.min(999, current + 1);
      onChange();
    });

    valueInput.addEventListener('change', () => {
      let newVal = parseInt(valueInput.value, 10) || 0;
      if (newVal < 0) newVal = 0;
      if (newVal > 999) newVal = 999;
      valueInput.value = newVal;
      onChange();
    });

    spinnerContainer.appendChild(minusBtn);
    spinnerContainer.appendChild(valueInput);
    spinnerContainer.appendChild(plusBtn);
    cellDiv.appendChild(spinnerContainer);

    return cellDiv;
  }

  function createSpinnerTable() {
    const table = document.getElementById('spinnerTable');
    table.innerHTML = '';

    let labelIndex = 0;
    for (let r = 0; r < NUM_ROWS; r++) {
      const row = table.insertRow();
      for (let c = 0; c < NUM_COLS; c++) {
        const cell = row.insertCell();
        const label = labels[labelIndex] || '';
        labelIndex++;
        const spinnerEl = createLabeledSpinner(label, updateFormData);
        cell.appendChild(spinnerEl);
      }
    }

    updateFormData();
  }

  function updateFormData() {
    const table = document.getElementById('spinnerTable');
    const data = [];

    for (let r = 0; r < table.rows.length; r++) {
      const rowData = [];
      for (let c = 0; c < table.rows[r].cells.length; c++) {
        const spinnerCell = table.rows[r].cells[c].querySelector('.spinner-cell');
        if (!spinnerCell) continue;

        const labelDiv = spinnerCell.querySelector('.spinner-label');
        const valueInput = spinnerCell.querySelector('.spinner-value');

        rowData.push({
          label: labelDiv.textContent,
          value: valueInput.value
        });
      }
      data.push(rowData);
    }

    if (window.JFCustomWidget && JFCustomWidget.sendData) {
      JFCustomWidget.sendData({ value: JSON.stringify(data) });
    }
  }

  if (window.JFCustomWidget) {
    JFCustomWidget.subscribe('ready', function() {
      createSpinnerTable();
    });

    JFCustomWidget.subscribe('submit', function() {
      updateFormData();
      JFCustomWidget.sendSubmit({ value: JSON.stringify(data) });
    });
  } else {
    window.onload = function() {
      createSpinnerTable();
    };
  }
</script>
</body>
</html>
